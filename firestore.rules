rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Regla para productos: solo usuarios autenticados pueden leer y escribir
    match /products/{productId} {
      allow read, write: if request.auth != null;
    }

    // Órdenes: solo usuarios autenticados (puedes ajustar para que clientes solo escriban y admin lea/edite)
    match /orders/{orderId} {
      allow read, write: if request.auth != null;
    }

    // Metadatos administrativos: solo usuarios con custom claim "admin": true
    match /admin_meta/{docId} {
      allow read, write: if request.auth != null && request.auth.token.admin == true;
    }

    // Denegar todo lo demás por defecto
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
